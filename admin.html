<!DOCTYPE html>
<html ng-app="mmpAdmin">
<head>
  <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	
  <title>mapMyPub | Admin</title>
  
  <link href="//fonts.googleapis.com/css?family=Playball" rel="stylesheet" />
  <link href="//fonts.googleapis.com/css?family=Raleway:600,400,300,200" rel="stylesheet" />
  <link href="//fonts.googleapis.com/css?family=Mrs+Sheppards" rel="stylesheet" />
  <link href="//fonts.googleapis.com/css?family=Pacifico" rel="stylesheet" >

  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" />
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  <link href="css/mapMyPub.css" rel="stylesheet" />
	
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.2/angular-resource.js"></script>
  <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?key=AIzaSyDgF9-hv09KVH_BYGZgv-Rund5lKZkLifM"></script>
  <script type="text/javascript" src="js/moment.min.js"></script>
  <script src="js/mmp-admin.js"></script>
</head>

<body class="admin-body" ng-controller="AppCtrl">
<div id="page-container" class="container-fluid height-100" ng-click="containerClicked($event)">
<div class="row height-100">
<div class="col-xs-12 height-100">
  <div class="site-title text-center">
  	<!--<h1 id="site-title">mapMyPub</h1>-->
  	<img src="../img/mmp-title.png" alt="MapMyPub" />
  	<h3>Administrator</h3>
	</div>
  
  <!--Edit Pub's beers-->
  <div id="addPubBeerForm" ng-controller="AddPubBeerCtrl" class="row" ng-cloak>
	    <div class="col-xs-12 col-md-10 col-md-offset-1 admin-form" ng-class="{closed: formsStatus[1]}">
	      <div class="admin-form-toggler"ng-click="toggleForm(1)"></div>
        <h1>Edit a Pub</h1>
        <div class="admin-form-content" ng-class="{invisible: formsStatus[1]}">
          <form name="addPubBeer" novalidate ng-submit="addPubBeerSubmit()">
            <div class="form-group text-left">
              <label for="pubNameInput">Pub</label>
              <input type="text" class="form-control" id="pubNameInput" placeholder="Search for a pub"
  	      									ng-model="forms.pub.name" 	
  	      									ng-change="getPubs()"
  	      									ng-keyDown="browsePubsResults($event)" />
    		      <ul id="pubs-typeahead" class="form-typeahead">
    		        <li ng-repeat="pub in forms.pubs" data-id="{{pub.id}}" ng-click="setFormPub(pub)" ng-class-even="'colored'">{{pub.name}} <span class="brewery">{{pub.address}}</span></li>
    		      </ul>
            </div>
          </form>
          
          <!--PUB DETAILS-->
          <div class="text-center" ng-if="!!pub.id">
            <h2>{{pub.name}}</h2>
            <p>{{pub.address}}</p>
            
            <section class="schedule" ng-controller="PubScheduleCtrl">
              <h3 ng-click="toggleMenu()">Schedule</h3>
              <hr ng-class="{hidden: !menuOpen}"/>
              <form name="pubSchedule" novalidate class="form-horizontal" ng-class="{hidden: !menuOpen}" ng-submit="editScheduleSubmit()" ng-cloak>
                <!--MONDAY-->
                <div class="form-group">
                  <label for="mondayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Monday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="mondayOpenInput" class="form-control" ng-model="pub.m_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.m_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="mondayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="mondayCloseInput" class="form-control" ng-model="pub.m_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.m_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                <!--TUESDAY-->
                <div class="form-group">
                  <label for="tuesdayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Tuesday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="tuesdayOpenInput" class="form-control" ng-model="pub.tu_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.tu_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="tuesdayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="tuesdayCloseInput" class="form-control" ng-model="pub.tu_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.tu_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                <!--WEDNESDAY-->
                <div class="form-group">
                  <label for="wednesdayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Wednesday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="wednesdayOpenInput" class="form-control" ng-model="pub.w_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.w_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="wednesdayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="wednesdayCloseInput" class="form-control" ng-model="pub.w_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.w_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                <!--THURSDAY-->
                <div class="form-group">
                  <label for="thursdayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Thursday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="thursdayOpenInput" class="form-control" ng-model="pub.th_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.th_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="thursdayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="thursdayCloseInput" class="form-control" ng-model="pub.th_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.th_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                <!--FRIDAY-->
                <div class="form-group">
                  <label for="fridayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Friday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="fridayOpenInput" class="form-control" ng-model="pub.f_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.f_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="fridayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="fridayCloseInput" class="form-control" ng-model="pub.f_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.f_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                <!--SATURDAY-->
                <div class="form-group">
                  <label for="saturdayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Saturday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="saturdayOpenInput" class="form-control" ng-model="pub.sa_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.sa_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="saturdayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="saturdayCloseInput" class="form-control" ng-model="pub.sa_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.sa_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                <!--SUNDAY-->
                <div class="form-group">
                  <label for="sundayOpenInput" class="col-sm-3 control-label">
                    <span class="day">Sunday</span>
                    Opening
                  </label>
                  <div class="col-sm-2">
                    <select name="sundayOpenInput" class="form-control" ng-model="pub.su_o">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.su_o" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                  <label for="sundayCloseInput" class="col-sm-3 control-label">Closing</label>
                  <div class="col-sm-2">
                    <select name="sundayCloseInput" class="form-control" ng-model="pub.su_c">
                      <option ng-repeat="time in pubTimes" ng-selected="time === pub.su_c" value="{{time}}">{{time}}</option>
                    </select>
                  </div>
                </div>
                
                <div class="row">
                  <div class="col-xs-12 text-center">
                    <button type="submit" class="btn btn-default" ng-disabled="pubSchedule.$pristine">Save</button>
                  </div>
                </div>
              </form>
            </section>
            
            <!--PUB MENU-->
            <section class="menu" ng-controller="PubMenuCtrl">
              <hr/>
              <h3 ng-click="toggleMenu()">Menu</h3>
              <hr ng-class="{hidden: !menuOpen}"/>
              
              <div class="beers" ng-class="{hidden: !menuOpen}">
                <div ng-repeat="beer in pubBeers" class="beer-card">
                  <i class="deleter fa fa-times-circle-o fa-lg" ng-click="deletePubBeer(beer)"></i>
                  <h4>{{beer.brewery_name}}</h4>
                  <h5>{{beer.name}}</h5>
                  <p class="abv" ng-if="beer.abv !== '0'">{{beer.abv}} %</p>
                  <hr ng-if="!!beer.description" />
                  <p class="description" ng-if="!!beer.description">{{beer.description | shortenToPoint}}</p>
                </div>
              </div>
            </section>
            
            <!--BEERS SELECTION-->
            <section>
              <hr/>
              <h1 class="text-left">Select beers to add</h1>
              <form name="addBeer" novalidate ng-submit="addBeersToPub()">
                <div class="form-group text-left">
                  <label for="BreweryInput">Brewery</label>
                  <input type="text" class="form-control" id="BreweryInput" placeholder="Search for a brewery"
      	      									ng-model="forms.brewery.name" 	
      	      									ng-change="getBreweries()"
      	      									ng-keyDown="browseBreweriesResults($event)" />
        		      <ul id="breweries-typeahead" class="form-typeahead">
        		        <li ng-repeat="brewery in forms.breweries" data-id="{{brewery.id}}" ng-click="setFormBrewery(brewery)" ng-class-even="'colored'">{{brewery.name}}</li>
        		      </ul>
                </div>
                
                <div class="beers" ng-if="!!brewery.id">
                  <div ng-controller="BeersListCtrl"
                       ng-repeat="beer in forms.beers"
                       class="text-center add-beer-card"
                       ng-class="{selected: selected}"
                       ng-click="toggleSelection(beer.id)"
                       data-id="{{beer.id}}">
                    <h4>{{beer.name}}</h4>
                    <p class="abv" ng-if="beer.abv !== '0'">{{beer.abv}} %</p>
                    <p class="description" ng-if="!!beer.description">{{beer.description | shortenToPoint}}</p>
                  </div>
                </div>
                
                <div class="row">
                  <div class="col-xs-12 text-center">
                    <button ng-if="!!brewery.id" type="submit" class="btn btn-default">Add these beers!</button>
                  </div>
                </div>
              </form>
            </section>
          </div>
        </div>
	    </div>
  </div>
  
  <!--Add a new pub form-->
	<div id="addPubForm" ng-controller="AddPubCtrl" class="row">
	    <div class="col-xs-12 col-md-10 col-md-offset-1 admin-form" ng-class="{closed: formsStatus[0]}">
	      <div class="admin-form-toggler"ng-click="toggleForm(0)"></div>
        <h1>Add a new pub</h1>
        <div class="admin-form-content" ng-class="{invisible: formsStatus[0]}">
          <form name="addPub" novalidate ng-submit="addPubSubmit()">
            <div class="form-group text-left">
              <label for="pubNameInput">Name</label>
              <input type="text" class="form-control" id="pubNameInput" name="pubName" placeholder="Les Berthom Terreaux..." required
                    ng-model="pub.name" />
              <div ng-show="addPub.$submitted || addPub.pubName.$touched" class="form-alert">
                <div ng-show="addPub.pubName.$error.required">A name is required</div>
              </div>
            </div>
            <div class="form-group text-left">
              <label for="pubAddressInput">Address</label>
              <input type="text" class="form-control" id="pubAddressInput" name="pubAddress" placeholder="24, rue Pizay, 69001 Lyon..." required 
                    ng-model="pub.address" />
              <div ng-show="addPub.$submitted || addPub.pubAddress.$touched" class="form-alert">
                <div ng-show="addPub.pubAddress.$error.required">We need an address to find it</div>
              </div>
            </div>
                
            <div id="pref-pane-alert" class="hidden">
              <span>
                This place couldn't be found.<br/>
                Please check the address and try again.
              </span>
            </div>
            <div class="col-xs-12 text-center">
              <button type="submit" class="btn btn-default" ng-disabled="!addPub.$valid">{{buttonText}}</button>
            </div>
          </form>
        </div>
	    </div>
  </div>
  
</div>
</div>
</div>
</body>
</html>